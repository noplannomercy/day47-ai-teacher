```
/exam í˜ì´ì§€ì— ê³¼ì œ ì „ë‹¬ ê¸°ëŠ¥ ì¶”ê°€í•´ì¤˜.

## ë°°ê²½
ì‹œí—˜ ì¶œì œ í›„ í•™ìƒë“¤ì—ê²Œ ê³¼ì œë¡œ ì „ë‹¬í•˜ëŠ” ê¸°ëŠ¥. êµì‚¬ê°€ ì¶œì œí•œ ì‹œí—˜ì„ í•™ìƒë“¤ì´ AI Tutorì—ì„œ í’€ ìˆ˜ ìˆë„ë¡ ì—°ê²°í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì˜ ì²« ë‹¨ê³„.

## ì‹ ê·œ í…Œì´ë¸” (ì´ë¯¸ Supabaseì— ìƒì„± ì™„ë£Œ)

```sql
CREATE TABLE teacher_assignments (
  id serial PRIMARY KEY,
  teacher_id text NOT NULL,
  exam_id integer REFERENCES teacher_exams(id),
  exam_content text NOT NULL,
  student_ids text[] NOT NULL,
  status text DEFAULT 'active',
  due_date timestamp,
  created_at timestamp DEFAULT now()
);

CREATE TABLE student_submissions (
  id serial PRIMARY KEY,
  assignment_id integer REFERENCES teacher_assignments(id),
  student_id text NOT NULL,
  answers jsonb NOT NULL DEFAULT '[]'::jsonb,
  score integer,
  grading_result text,
  status text DEFAULT 'pending',
  submitted_at timestamp,
  graded_at timestamp,
  created_at timestamp DEFAULT now()
);
```

## ê¸°ì¡´ í…Œì´ë¸” ì°¸ê³ 

```sql
-- ì‹œí—˜ ì¶œì œ ê²°ê³¼ ì €ì¥ (ì´ë¯¸ ë™ì‘ ì¤‘)
teacher_exams (id, teacher_id, topic, difficulty, exam_content, student_id, created_at)

-- í•™ìƒ ëª©ë¡ (ë“œë¡­ë‹¤ìš´ìš©, ì´ë¯¸ ë™ì‘ ì¤‘)
student_profiles (user_id, display_name, level, score_range, avatar_emoji, created_at)
```

## êµ¬í˜„ ë‚´ìš©

### 1. /exam í˜ì´ì§€ ìˆ˜ì •
ì‹œí—˜ ì¶œì œ ê²°ê³¼ê°€ í‘œì‹œëœ í›„ (íƒ­ 3ê°œ ì•„ë˜) **[ê³¼ì œë¡œ ì „ë‹¬]** ë²„íŠ¼ ì¶”ê°€.

### 2. ë²„íŠ¼ í´ë¦­ ì‹œ ì²˜ë¦¬ ë¡œì§
Supabase ì§ì ‘ INSERT (n8n webhook ë¶ˆí•„ìš”):

a. student_profilesì—ì„œ ì „ì²´ í•™ìƒ uid ëª©ë¡ ì¡°íšŒ
b. teacher_assignments INSERT:
   - teacher_id: í˜„ì¬ ë¡œê·¸ì¸ êµì‚¬ uid
   - exam_id: í˜„ì¬ ì¶œì œëœ ì‹œí—˜ì˜ teacher_exams.id (ì¶œì œ ì‹œ ë°˜í™˜ë°›ê±°ë‚˜ ê°€ì¥ ìµœê·¼ ê²ƒ ì¡°íšŒ)
   - exam_content: ì¶œì œëœ ì‹œí—˜ ì „ì²´ í…ìŠ¤íŠ¸ (n8n ì‘ë‹µ output)
   - student_ids: ì „ì²´ í•™ìƒ uid ë°°ì—´ (text[])
   - status: 'active'
c. ë°˜í™˜ëœ assignment.idë¡œ student_submissions INSERT (í•™ìƒ ìˆ˜ë§Œí¼):
   - assignment_id: ìœ„ì—ì„œ ë°˜í™˜ëœ id
   - student_id: ê° í•™ìƒ uid
   - answers: '[]'::jsonb (ë¹ˆ ë°°ì—´)
   - status: 'pending'

### 3. UI ìƒíƒœ
- ì¶œì œ ì „: ë²„íŠ¼ ì—†ìŒ
- ì¶œì œ ì™„ë£Œ: [ğŸ“¤ ê³¼ì œë¡œ ì „ë‹¬] ë²„íŠ¼ í‘œì‹œ
- ì „ë‹¬ ì¤‘: ë¡œë”© ìŠ¤í”¼ë„ˆ
- ì „ë‹¬ ì™„ë£Œ: "âœ… 4ëª…ì—ê²Œ ì „ë‹¬ ì™„ë£Œ" ë¹„í™œì„±í™” ìƒíƒœ
- ì—ëŸ¬: í† ìŠ¤íŠ¸ë¡œ ì—ëŸ¬ ë©”ì‹œì§€

### 4. exam_id í™•ë³´ ë°©ë²•
í˜„ì¬ ì‹œí—˜ ì¶œì œëŠ” n8n webhookì´ ì²˜ë¦¬í•˜ê³  DB INSERTë„ n8n ë‚´ë¶€ì—ì„œ í•¨.
í”„ë¡ íŠ¸ì—ì„œ exam_idë¥¼ ëª¨ë¥´ë¯€ë¡œ, ê³¼ì œ ì „ë‹¬ ì‹œ:
```typescript
// ê°€ì¥ ìµœê·¼ ì¶œì œëœ ì‹œí—˜ ì¡°íšŒ
const { data: latestExam } = await supabase
  .from('teacher_exams')
  .select('id')
  .eq('teacher_id', teacherId)
  .order('created_at', { ascending: false })
  .limit(1)
  .single()
```

### 5. Supabase ì¿¼ë¦¬ ì˜ˆì‹œ
```typescript
// í•™ìƒ ì „ì²´ ì¡°íšŒ
const { data: students } = await supabase
  .from('student_profiles')
  .select('user_id')

const studentIds = students.map(s => s.user_id)

// assignment INSERT
const { data: assignment } = await supabase
  .from('teacher_assignments')
  .insert({
    teacher_id: teacherId,
    exam_id: latestExam.id,
    exam_content: examOutput,
    student_ids: studentIds,
    status: 'active'
  })
  .select('id')
  .single()

// submissions INSERT (í•™ìƒë³„)
const submissions = studentIds.map(sid => ({
  assignment_id: assignment.id,
  student_id: sid,
  answers: [],
  status: 'pending'
}))

await supabase
  .from('student_submissions')
  .insert(submissions)
```

ì™„ë£Œ í›„ npm run build í†µê³¼ í™•ì¸.
```
