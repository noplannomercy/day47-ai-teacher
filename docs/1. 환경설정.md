# AI Teacher Phase3: 프론트엔드 환경설정

> 별도 프로젝트: day47-ai-teacher (학생용 ai-tutor-poc과 분리)

---

## 1. 프로젝트 생성

```bash
mkdir day47-ai-teacher
cd day47-ai-teacher
npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*"
```

## 2. shadcn/ui

```bash
npx shadcn@latest init
npx shadcn@latest add button input card avatar badge scroll-area separator sheet skeleton tabs textarea select toast
```

## 3. Supabase Auth + Client

```bash
npm install @supabase/supabase-js @supabase/ssr
```

## 4. 마크다운 + 수식 렌더링

```bash
npm install react-markdown remark-math rehype-katex katex react-katex
npm install -D @types/katex @types/react-katex
```

## 5. 기타

```bash
npm install lucide-react
```

## 6. 환경 변수

`.env.local`:

```
NEXT_PUBLIC_SUPABASE_URL=https://muefuihjjihdihzjpvbk.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11ZWZ1aWhqamloZGloempwdmJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NTA5NzIsImV4cCI6MjA4NjUyNjk3Mn0.K0Y4I3GbEujUIiZWRf8G4ed8htgcyl4__VIeUvrcFNM
NEXT_PUBLIC_MEM0_API_URL=http://193.168.195.222:8888

# 교사용 n8n Webhook
NEXT_PUBLIC_N8N_REPORT_URL=https://n8n.srv812064.hstgr.cloud/webhook/6350e749-78cb-4a00-890d-cfa59faafac8
NEXT_PUBLIC_N8N_EXAM_URL=https://n8n.srv812064.hstgr.cloud/webhook/1f37ac96-50f1-4cea-8a5e-31a9843760d4
NEXT_PUBLIC_N8N_LESSON_URL=https://n8n.srv812064.hstgr.cloud/webhook/22c86e3e-3b64-4fd8-8d97-a92d3235a857
NEXT_PUBLIC_N8N_GRADING_URL=https://n8n.srv812064.hstgr.cloud/webhook/a9301e60-32a3-4d8b-b7c7-cb1ac5a631ef
```

> ⚠️ 위 webhook URL은 현재 test URL임. Production 전환 시 각 워크플로우 Activate 후 production URL로 교체 필요.

## 7. 디렉토리 구조

```bash
mkdir -p src/lib/supabase
mkdir -p src/components/teacher
mkdir -p src/components/landing
mkdir -p src/components/ui
mkdir -p src/app/report
mkdir -p src/app/exam
mkdir -p src/app/lesson
mkdir -p src/app/grading
```

```
src/
├── app/
│   ├── layout.tsx
│   ├── page.tsx                    # 랜딩 (/)
│   ├── report/
│   │   └── page.tsx                # 학생 리포트 (/report)
│   ├── exam/
│   │   └── page.tsx                # 시험 출제 (/exam)
│   ├── lesson/
│   │   └── page.tsx                # 교안 생성 (/lesson)
│   └── grading/
│       └── page.tsx                # 자동 채점 (/grading)
├── components/
│   ├── landing/
│   │   ├── hero.tsx                # 히어로 섹션
│   │   ├── feature-cards.tsx       # 4개 기능 카드
│   │   └── demo-login.tsx          # 데모 로그인
│   ├── teacher/
│   │   ├── teacher-nav.tsx         # 상단/사이드 네비게이션
│   │   ├── student-selector.tsx    # 학생 선택 드롭다운
│   │   ├── report-form.tsx         # 리포트 요청 폼
│   │   ├── report-result.tsx       # 리포트 결과 (마크다운 렌더링)
│   │   ├── exam-form.tsx           # 출제 조건 폼
│   │   ├── exam-result.tsx         # 시험지/정답지/채점기준
│   │   ├── lesson-form.tsx         # 교안 조건 폼
│   │   ├── lesson-result.tsx       # 교안 결과
│   │   ├── grading-form.tsx        # 채점 입력 폼
│   │   ├── grading-result.tsx      # 채점 결과 + 오답 분석
│   │   └── markdown-renderer.tsx   # 마크다운 + KaTeX 렌더러
│   └── ui/                         # shadcn 컴포넌트
├── lib/
│   ├── supabase/
│   │   ├── client.ts               # 브라우저 클라이언트
│   │   ├── server.ts               # 서버 클라이언트
│   │   └── middleware.ts           # auth guard
│   ├── api.ts                      # n8n webhook 호출 함수 4개
│   └── types.ts                    # 타입 정의
└── middleware.ts                    # auth redirect
```

---

## 8. 인증 분기 로직

middleware.ts에서:

```
로그인 → teacher_profiles에 uid 있으면 → 통과
로그인 → teacher_profiles에 uid 없으면 → / (랜딩)으로 리다이렉트
미로그인 → / (랜딩)
```

> 이 앱은 교사 전용. 학생 계정으로 로그인 시 접근 차단.

---

## 9. Supabase Auth 계정

### 교사 계정

| 이메일 | 비밀번호 | uid |
|--------|----------|-----|
| teacher-kim@demo.com | demo1234 | (Supabase에서 확인) |

### 학생 계정 (리포트/채점 대상, 로그인 불가)

| 학생 | uid |
|------|-----|
| 김상위 | 3a0d951f-6fe7-49cf-96e9-d9194fc723fc |
| 이중위 | f273885e-dcb3-4ae5-8155-292445b9f4ca |
| 박하위 | 066a45cd-9db3-4bd2-bd53-ac89c04cb29b |
| 최기초 | a1fac652-00f1-461f-b8f5-b740434614ae |

---

## 10. DB 테이블 (이미 생성 완료)

```sql
-- 교사 프로필
teacher_profiles (user_id, display_name, subject, role, created_at)

-- 학생 프로필 (학생 선택 드롭다운용)
student_profiles (user_id, display_name, level, score_range, avatar_emoji)

-- 교사 산출물
teacher_reports (id, teacher_id, student_id, report_content, created_at)
teacher_exams (id, teacher_id, topic, difficulty, exam_content, student_id, created_at)
teacher_lesson_plans (id, teacher_id, topic, duration, plan_content, created_at)
teacher_gradings (id, teacher_id, student_id, problems, grading_result, total_score, created_at)
```

---

## 11. n8n Webhook URL 매핑

| 기능 | 워크플로우 | Webhook (test) |
|------|-----------|----------------|
| 학생 리포트 | AI Teacher Phase3 - 학생 리포트 | /webhook-test/6350e749-... |
| 시험 출제 | AI Teacher Phase3 - 시험 출제 | /webhook-test/1f37ac96-... |
| 교안 생성 | AI Teacher Phase3 - 교안 생성 | /webhook-test/22c86e3e-... |
| 자동 채점 | AI Teacher Phase3 - 자동 채점 | /webhook-test/a9301e60-... |

> Production 전환: 각 워크플로우 Activate → webhook-test를 webhook으로 변경

---

## 12. 빌드 확인

```bash
npm run build
```